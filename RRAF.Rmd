---
title: "Lobsters"
author: "Alicia Fennell and Rachel Rhodes"
date: "11/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, include = FALSE) ## edit this. Look at assignment 2
```

```{r}

# Attach packages and read in lobster data

library(tidyverse)
library(here)
library(janitor)
library(tidyr)
library(ggridges)
library(directlabels)

```

## Results A


```{r}

## Creating tidy data

lobster_ab <- read_csv("lobster_abundance_sbc_lter.csv", na = "-99999") %>% 
  clean_names()

lobster_tidy <- lobster_ab %>% 
  uncount(count)

annual_ab_site <- lobster_tidy %>% 
  group_by(year) %>% 
  count(site)  %>% 
  mutate(site_type = if_else(site %in% c("IVEE","NAPL"), "MPA", "Non-MPA")) %>% 
  mutate(site = replace(site, site == "IVEE", "Isla Vista")) %>% 
  mutate(site = replace(site, site == "CARP", "Carpinteria")) %>% 
  mutate(site = replace(site, site == "AQUE", "Arroyo Quemado")) %>% 
  mutate(site = replace(site, site == "MOHK", "Mohawk")) %>% 
  mutate(site = replace(site, site == "NAPL", "Naples"))
                                          
         
```

```{r}

## Exploratory graphs


# ggplot(annual_ab_site, aes(x = year, y = n)) +
#   geom_line(aes(color = site)) +
#   theme_minimal()
# 
# ggplot(annual_ab_site, aes(x = year, y = n)) +
#   geom_bar(stat = "identity") +
#   facet_wrap(~site) +
#   theme_minimal() 

```


```{r}

## Results A - visualalization showing  changes in annual lobster abundace at the five sites over time, designating MPA versus non-MPA sites. 

ggplot(annual_ab_site, aes(x = year, y = n)) +
  geom_line(aes(group = site,
                color = site_type), 
            size = 0.75) +
  theme_minimal()+
  theme(
    legend.position = c(0.27, .88),
    legend.justification = c("right", "top"),
    legend.box.just = "right",
    legend.margin = margin(6, 6, 6, 6),
    legend.background = element_rect("white"))+
  xlim(2012,2019.5) +
  geom_dl(aes(label=site,
              color = site_type),
          method = "last.points") +
  ggtitle("CALIFORNIA SPINY LOBSTER ABUNDANCE",
          subtitle = "Santa Barbara Channel (2012 - 2018)")+
  labs(x = "Year",
       y = "Lobster count",
       color = "Site Type")
```

## Results B


```{r}
lobster_size <- lobster_tidy %>% 
  filter(year == c(2012, 2018))
```

```{r}
ggplot(lobster_size, aes(x = site, y = size_mm, color = factor(year))) +
  geom_violin(alpha = 0.5) 

```
