---
title: "Lobsters"
author: "Alicia Fennell and Rachel Rhodes"
date: "11/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, include = FALSE) ## edit this. Look at assignment 2
```

```{r}
# read in lobster data

library(tidyverse)
library(here)
library(janitor)
library(tidyr)
library(ggridges)

lobster_ab <- read_csv("lobster_abundance_sbc_lter.csv", na = "-99999") %>% 
  clean_names()

lobster_tidy <- lobster_ab %>% 
  uncount(count)
```

## Results A


```{r}
annual_ab_site <- lobster_tidy %>% 
  group_by(year) %>% 
  count(site)
```

```{r}
ggplot(annual_ab_site, aes(x = year, y = n)) +
  geom_line(aes(color = site)) +
  theme_minimal()
```

```{r}
ggplot(annual_ab_site, aes(x = year, y = n)) +
  geom_bar(stat = "identity") +
  facet_wrap(~site) +
  theme_minimal() 
```



```{r}

cols <- c("IVEE" = "black", "NAPL" = "black", "AQUE" = "royalblue", "MOHK" = "royalblue", "CARP" = "royalblue")

ggplot(annual_ab_site, aes(x = year, y = n)) +
  geom_line(aes(color = site), 
            show.legend = FALSE) +
  theme_minimal() +
  scale_colour_manual(values = cols) +
  geom_text(x = 2018,
            y = 800,
            label = "Isla Vista",
            color = "black")
  
  
```

## Results B


```{r}
lobster_size <- lobster_tidy %>% 
  filter(year == c(2012, 2018))
```

```{r}
ggplot(lobster_size, aes(x = site, y = size_mm, color = factor(year))) +
  geom_violin(alpha = 0.5)

```
